(()=>{let calendar={orderBy:'startTime',showLocation:!1,offsetMax:72,offsetMin:4,showDeleted:!1,singleEvents:!0,maxResults:250},now=(Object.assign(calendar,CONFIG.calendar),new Date);var timeMax=new Date,timeMin=new Date,timeMax=(timeMax.setHours(now.getHours()+calendar.offsetMax),timeMin.setHours(now.getHours()-calendar.offsetMin),{key:calendar.api_key,orderBy:calendar.orderBy,timeMax:timeMax.toISOString(),timeMin:timeMin.toISOString(),showDeleted:calendar.showDeleted,singleEvents:calendar.singleEvents,maxResults:calendar.maxResults});let request_url=new URL(`https://www.googleapis.com/calendar/v3/calendars/${calendar.calendar_id}/events`);function buildEventDOM(tense,event,start,end){var durationFormat={weekday:'short',hour:'2-digit',minute:'2-digit'},relativeTime='now'===tense?'NOW':function getRelativeTime(current,previous){return previous=0<(current-=previous)?' ago':' later',(current=Math.abs(current))<36e5?Math.round(current/6e4)+' minutes'+previous:current<864e5?Math.round(current/36e5)+' hours'+previous:current<2592e6?'about '+Math.round(current/864e5)+' days'+previous:current<31536e6?'about '+Math.round(current/2592e6)+' months'+previous:'about '+Math.round(current/31536e6)+' years'+previous}(now,start),start=start.toLocaleTimeString([],durationFormat)+' - '+end.toLocaleTimeString([],durationFormat);let location='',description=(calendar.showLocation&&event.location&&(location=`<span class="event-location event-details">${event.location}</span>`),'');return event.description&&(description=`<span class="event-description event-details">${event.description}</span>`),`<section class="event event-${tense}">
        <h2 class="event-summary">
          ${event.summary}
          <span class="event-relative-time">${relativeTime}</span>
        </h2>
        ${location}
        <span class="event-duration event-details">${start}</span>
        ${description}
      </section>`}async function fetchData(){let eventList=document.querySelector('.event-list');if(eventList)try{var data=await(await fetch(request_url.href)).json();if(0===data.items.length)eventList.innerHTML='<hr>';else{eventList.innerHTML='';let prevEnd=0,utc=6e4*(new Date).getTimezoneOffset();data.items.forEach(event=>{var start=new Date(event.start.dateTime||new Date(event.start.date).getTime()+utc),end=new Date(event.end.dateTime||new Date(event.end.date).getTime()+utc);let tense='now';end<now?tense='past':start>now&&(tense='future'),'future'===tense&&prevEnd<now&&eventList.insertAdjacentHTML('beforeend','<hr>'),eventList.insertAdjacentHTML('beforeend',buildEventDOM(tense,event,start,end)),prevEnd=end})}}catch(error){console.error('Error fetching calendar data:',error)}}Object.entries(timeMax).forEach(param=>request_url.searchParams.append(...param)),fetchData();let fetchDataTimer=setInterval(fetchData,6e4);document.addEventListener('pjax:send',()=>{clearInterval(fetchDataTimer)})})();