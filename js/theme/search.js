let initSearch=()=>{(()=>{if(GLOBALCONFIG.search.path){let localSearch=new LocalSearch({path:GLOBALCONFIG.root+GLOBALCONFIG.search.path,top_n_per_article:GLOBALCONFIG.search.local.top_n_per_article,unescape:!1}),input=document.querySelector('#search-input'),container=document.querySelector('.search-result-container'),searchOverlay=document.querySelector('.search-overlay');var inputEventFunction=()=>{if(localSearch.isfetched){var searchText=input.value.trim().toLowerCase(),keywords=searchText.split(/[-\s]+/);let resultItems=[];0<searchText.length&&(resultItems=localSearch.getResultItems(keywords)),1===keywords.length&&''===keywords[0]||0===resultItems.length?container.innerHTML='<div class="search-result-icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M10 10m-7 0a7 7 0 1 0 14 0a7 7 0 1 0 -14 0" /><path d="M21 21l-6 -6" /></svg></div>':(resultItems.sort((left,right)=>left.includedCount!==right.includedCount?right.includedCount-left.includedCount:left.hitCount!==right.hitCount?right.hitCount-left.hitCount:right.id-left.id),container.innerHTML=`<div class="search-stats">${resultItems.length+' results found'}</div><ul class="search-result-list">${resultItems.map(result=>result.item.replace(/(<a href="[^\?]+)\?highlight=[^"]+"( class|>)/g,'$1"$2')).join('')}</ul>`)}};GLOBALCONFIG.search.local.preload&&localSearch.fetchData(),input.addEventListener('input',inputEventFunction),window.addEventListener('search:loaded',inputEventFunction),document.getElementById('search-btn').addEventListener('click',()=>{searchOverlay.hasAttribute('active')?searchOverlay.removeAttribute('active'):searchOverlay.setAttribute('active',''),setTimeout(()=>input.focus(),500),localSearch.isfetched||localSearch.fetchData()});let onPopupClose=()=>{searchOverlay.removeAttribute('active')};searchOverlay.addEventListener('click',event=>{event.target===searchOverlay&&onPopupClose()}),document.querySelector('.search-close-btn').addEventListener('click',onPopupClose),window.addEventListener('keyup',event=>{'Escape'===event.key&&onPopupClose()})}else console.warn('`hexo-generator-searchdb` plugin is not installed or configured!')})()};export default initSearch;