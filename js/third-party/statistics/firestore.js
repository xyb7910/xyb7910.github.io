firebase.initializeApp({apiKey:CONFIG.firestore.apiKey,projectId:CONFIG.firestore.projectId}),(()=>{let getCount=async(doc,increaseCount)=>{var d=await doc.get();let count=d.exists?d.data().count:0;return increaseCount&&(count++,doc.set({count:count})),count},articles=firebase.firestore().collection(CONFIG.firestore.collection);document.addEventListener('page:loaded',async()=>{if(CONFIG.page.isPost){var title=document.querySelector('.post-title').textContent.trim(),doc=articles.doc(title);let increaseCount=CONFIG.hostname===location.hostname;localStorage.getItem(title)?increaseCount=!1:localStorage.setItem(title,!0);title=await getCount(doc,increaseCount);document.querySelector('.firestore-visitors-count').innerText=title}else if(CONFIG.page.isHome){doc=[...document.querySelectorAll('.post-title')].map(element=>{element=element.textContent.trim(),element=articles.doc(element);return getCount(element)}),title=await Promise.all(doc);let metas=document.querySelectorAll('.firestore-visitors-count');title.forEach((val,idx)=>{metas[idx].innerText=val})}})})();